---
import { getCollection } from 'astro:content';
import { useTranslations } from '../i18n/utils';
import type { Lang } from '../i18n/utils';
import ServicioCard from './servicios/ServicioCard.astro';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const servicios = (await getCollection('servicios'))
  .filter(s => s.data.lang === lang)
  .sort((a, b) => a.data.order - b.data.order);

/* Los tres tonos de azul de los pilares:
   1 → azul profundo   2 → azul principal   3 → azul cielo */
const pillarColors = ['#1E3A8A', '#2563EB', '#0369A1'];
---

<section
  id="servicios"
  class="servicios-section w-full px-6 pt-10 pb-18 md:px-16 md:pt-14 md:pb-28"
>
  <div class="max-w-300 mx-auto flex flex-col gap-14">

    <!-- ── Intro ── -->
    <div class="flex flex-col items-center text-center gap-4 max-w-2xl mx-auto">

      <span class="inline-flex items-center gap-1.5
                   text-[0.72rem] font-bold tracking-[0.12em] uppercase
                   text-(--color-contrast) border border-(--color-contrast)/30
                   px-3.5 py-1.5 rounded-full">
        {t.servicios.badge}
      </span>

      <h2 class="text-[clamp(1.8rem,3.5vw,2.8rem)] font-extrabold leading-[1.15]
                 mt-0 mb-0 text-(--color-text)">
        {t.servicios.titulo}
      </h2>

      <p class="text-[1.05rem] leading-[1.75] text-(--color-text)/60 mt-0 mb-0">
        {t.servicios.desc}
      </p>

    </div>

    <!-- ── Tarjetas: 3 columnas ── -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      {servicios.map((s, i) => (
        <ServicioCard
          titulo={s.data.title}
          desc={s.data.summary}
          icono={s.data.icon}
          color={pillarColors[i % 3]}
        />
      ))}
    </div>

  </div>
</section>

<style>
  .servicios-section {
    background: color-mix(in srgb, var(--color-primary) 6%, var(--color-base));
  }
</style>
